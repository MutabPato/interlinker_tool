{% extends 'interlinker/base.html' %}

{% block title %}Stored Internal Links | Interlinker{% endblock %}
{% block meta_description %}Search, filter, and audit the internal links captured from your sitemaps to ensure editorial accuracy.{% endblock %}

{% block content %}
<section class="section">
    <header class="section-header">
        <h1>Stored internal links</h1>
        <p>Filter by domain or search for a keyword to review the URLs available for internal linking.</p>
    </header>

    <form method="get" class="filter-form" role="search">
        <div class="field-group">
            <label for="domain">Domain</label>
            <select name="domain" id="domain">
                <option value="">All</option>
                {% for d in domains %}
                    <option value="{{ d.id }}" {% if d.id|stringformat:"s" == selected_domain|stringformat:"s" %}selected{% endif %}>{{ d.base_url }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="field-group">
            <label for="q">Keyword</label>
            <input type="text" name="q" id="q" value="{{ query }}" placeholder="e.g. cold wallets" />
        </div>
        <button type="submit" class="btn btn-secondary">Filter</button>
        {% if query or selected_domain %}
            <a class="btn btn-link" href="{% url 'interlinker:sitemap_links' %}">Clear filters</a>
        {% endif %}
    </form>

    <p class="small">{{ links|length }} link{{ links|length|pluralize }} available.</p>

    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th scope="col">URL</th>
                    <th scope="col">Slug</th>
                    <th scope="col">Domain</th>
                </tr>
            </thead>
            <tbody>
                {% for link in links %}
                <tr>
                    <td data-label="URL"><a href="{{ link.url }}" target="_blank" rel="noopener">{{ link.url }}</a></td>
                    <td data-label="Slug">{{ link.slug }}</td>
                    <td data-label="Domain">{{ link.domain.base_url }}</td>
                </tr>
                {% empty %}
                <tr><td colspan="3">No links stored yet. Upload a sitemap to get started.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>
{% endblock %}
